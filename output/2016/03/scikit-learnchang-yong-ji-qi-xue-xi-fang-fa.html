<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>耕有田，读有书</title>
    <link rel="stylesheet" type="text/css" href="http://forin-xyz.github.io/output/theme/css/screen.min.css">
    <link rel="stylesheet" type="text/css" href="http://forin-xyz.github.io/output/theme/css/highlight.min.css">
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400" />
    <link rel="publisher" href="">
    <link rel="apple-touch-startup-image" href="http://forin-xyz.github.io/output/theme/images/logo.png">
    <link type="text/plain" rel="socialmedia" href="http://forin-xyz.github.io/output/socialmedia.txt">
    <link rel="dns-prefetch" href="http://forin-xyz.github.io/output"/>
    <link rel="dns-prefetch" href="//www.gstatic.com"/>
    <link rel="dns-prefetch" href="//fonts.gstatic.com"/>
    <link rel="dns-prefetch" href="//fonts.googleapis.com"/>
    <link rel="dns-prefetch" href="//accounts.google.com"/>
    <link rel="dns-prefetch" href="//ssl.google-analytics.com"/>
    <link rel="dns-prefetch" href="//www.google-analytics.com"/>
    <link rel="dns-prefetch" href="//googleads.g.doubleclick.net"/>
    <link rel="dns-prefetch" href="//pagead2.googlesyndication.com"/>
    <link rel="dns-prefetch" href="//twemoji.maxcdn.com"/>
    <meta http-equiv="content-type" content="text/html;charset=utf-8">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="application-name" content="耕有田，读有书"/>
    <meta name="msapplication-starturl" content="http:http://forin-xyz.github.io/output"/>
    <meta name="msapplication-tooltip" content=""/>
    <meta name="msapplication-window" content="width=1024;height=768"/>
    <meta name="msapplication-task" content="name=耕有田，读有书;action-uri=http:http://forin-xyz.github.io/output;icon-uri=http://forin-xyz.github.io/output/theme/images/favicon.ico"/>
    <meta name="msapplication-TileImage" content="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-144x144.png"/>
    <meta name="msapplication-TileColor" content="#1F1F21"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta http-equiv="imagetoolbar" content="no">
    <meta http-equiv="pragma" content="cache">
    <meta http-equiv="cache-control" content="cache">
    <meta http-equiv="vary" content="content-language">
    <meta http-equiv="Cache-control" content="max-age=2592000, public">
    <meta http-equiv="content-style-type" content="text/css">
    <meta name="application-name" content="耕有田，读有书">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="google-site-verification" content="">
    <meta name="alexaVerifyID" content=""/>
    <meta name="wot-verification" content=""/>
    <meta name="msvalidate.01" content="" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="medium" content="mult">
    <meta name="adblock" content="disable">
    <meta name="rating" content="General">
    <meta name="resource-type" content="document">
    <meta name="revisit-after" content="1 days">
    <meta name="revisit" content="1">
    <meta name="robots" content="index,follow">
    <meta name="no-email-collection" content="http://www.unspam.com/noemailcollection/">
    <link rel="apple-touch-icon" sizes="152x152" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="144x144" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="114x114" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="72x72" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="60x60" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="57x57" href="http://forin-xyz.github.io/output/theme/images/apple-touch-icon-57x57.png">
    <link rel="icon" type="image/png" href="http://forin-xyz.github.io/output/theme/images/favicon-196x196.png" sizes="196x196">
    <link rel="icon" type="image/png" href="http://forin-xyz.github.io/output/theme/images/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="http://forin-xyz.github.io/output/theme/images/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="http://forin-xyz.github.io/output/theme/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://forin-xyz.github.io/output/theme/images/favicon-16x16.png" sizes="16x16">
    <link rel="shortcut icon" href="http://forin-xyz.github.io/output/theme/images/favicon.ico">
    <script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', '', 'auto');ga('send', 'pageview');var _qevents = _qevents || [];</script>
    <script src="//twemoji.maxcdn.com/twemoji.min.js"></script>
</head>
<body class="home-template nav-closed" itemscope itemtype="http://schema.org/WebPage">
<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-ML9KT2"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-ML9KT2');</script>
<!-- End Google Tag Manager -->
    <meta itemprop="name" content="耕有田，读有书">
    <meta itemprop="url" content="http://forin-xyz.github.io/output">
    <meta itemprop="headline" content="耕有田，读有书 || ">
    <meta itemprop="description about" content="">
    <meta itemprop="keywords" content="gnu, linux, software libre, código abierto, tecnología">
    <meta itemprop="primaryImageOfPage" content="http://forin-xyz.github.io/output/theme/images/logo.png">
    <meta itemprop="inLanguage" content="es">
<nav class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul role="menubar">
            <li class="nav-current" role="presentation"><a  href="http://forin-xyz.github.io/output/archives.html" title="耕有田，读有书 | Archives" itemprop="name" itemprop="significantLink">Archives</a></li>        
    </ul>
    <a class="subscribe-button icon-feed" href='http://cloud.feedly.com/#subscription%2Ffeed%2Fhttp%3A%2F%2Ffeeds.feedburner.com%2FElBlogDeAbr4xas'  target='blank'>Subscribe</a>
</nav>
<span class="nav-cover"></span>    <div class="site-wrapper">
        <header class="main-header post-head" style="background-image: url(http://forin-xyz.github.io/output/theme/images/bear.jpg)" itemscope itemtype="http://schema.org/WPHeader">
            <nav class="main-nav overlay clearfix">
                <a class="menu-button" href="#">
                    <span class="burger">&#9776;</span>
                    <span class="word">Menu</span>
                </a>
            </nav>
            <div class="vertical">
                <div class="main-header-content inner">
                    <h1 class="page-title" itemprop="headline">耕有田，读有书</h1>
                    <h2 class="page-description" itemprop="description"></h2>
                </div>
            </div>
            <a class="scroll-down icon-arrow-left blink_me" href="#content" data-offset="-45">
                <span class="hidden">Scroll Down</span>
            </a>
        </header>
<main id="content" class="content" role="main">
    <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
        <header class="post-header">
            <h1 class="post-title" itemprop="headline">scikit-learn常用机器学习方法</h1>
            <section class="post-meta">
                <span class="entry-author" itemscope="" itemtype="http://schema.org/Person" itemprop="author">
                    <span itemprop="name">forin-xyz</span></span>
                <time class="post-date" itemprop="datePublished" datetime="2016YYY-20M-%DD">Saturday, March 05, 2016</time>
<nav role="navigation">
    <a class="newer-posts blink_me" href="http://forin-xyz.github.io/output">&larr; Back</a>
</nav><br/>            </section>
        </header>
        <section class="post-content">
            <h2>数据导入</h2>
<p>可以使用numpy的loadtxt方法导入csv文件</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="c1"># fn是文件路径 或者 是拥有read方法的对象实例</span>
<span class="n">np</span><span class="o">.</span><span class="kp">loadtxt</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
</pre></div>


<h2>数据预处理, 数据标准化</h2>
<h3>StandardScaler</h3>
<p>使训练集每一个特征值<strong>0-均值,1-方差</strong>, 作用在训练集的列(column)上</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="n">standard_scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
<span class="c1"># 训练并转换数据集</span>
<span class="n">Xt</span> <span class="o">=</span> <span class="n">standard_scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># 转换新的数据集</span>
<span class="n">standard_scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># 原训练集均值</span>
<span class="n">standard_scaler</span><span class="o">.</span><span class="n">mean_</span>
<span class="c1"># 原训练集标准差</span>
<span class="n">standard_scaler</span><span class="o">.</span><span class="n">std_</span>
</pre></div>


<h3>MinMaxScaler, MaxAbsScaler</h3>
<p>指定的极差, 默认min=0, max=1, max_abs=1</p>
<div class="highlight"><pre><span></span>min_max_scaler = preprocessing.MinMaxScaler()
min_max_scaler.fit(X)
min_max_scaler.transform(x)
# min_, 原训练集各个特征最小值, scale_, 原训练集各个特征的范围(scale = max-min)
min_max_scaler.min_
min_max_scaler.scale_
</pre></div>


<p>对于<strong>稀疏矩阵(sparse matrices)</strong>非常有效</p>
<h3>Normalizer</h3>
<p>使每一个样本具有<strong>单位范数, norm=1</strong>, 作用在训练集的行(row)上</p>
<div class="highlight"><pre><span></span># norm in `{l1, l2, max}`, default norm=&#39;l2&#39;
normalizer = preprocessing.Normalizer(norm=&#39;l1&#39;)
normalizer.fit(X)
normalizer.transform(X)
</pre></div>


<p><strong>小写的scale, minmax_scale, maxabs_scale, normalize是方法, 可以直接将数据集标准化, 返回值就是转化后的新数据集, 但是不能够对新的数据按照相同的参数进行转化</strong></p>
<h2>特征提取</h2>
<h2>特征降维, 主成分分析PCA, 独立成分分析ICA, 因子分析FA</h2>
<h3>PCA, principal component analysis</h3>
<p>只对符号高斯分布的样本点比较有效</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">decomposition</span>
<span class="c1"># n_components : int, 向量个数</span>
<span class="c1"># float: 0&lt;n&lt;1, the amount of variance that needs to greater than n.</span>
<span class="c1"># &#39;mle&#39;: 极大似然估计</span>
<span class="c1"># None: min(n_samples, n_features)</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">decompositon</span><span class="o">.</span><span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">pca</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># 最大方差的方向, 特征空间的主要坐标轴</span>
<span class="n">pca</span><span class="o">.</span><span class="n">components_</span>
<span class="c1"># explained_variance_ratio_ : 所选取的向量对应的方差的百分数</span>
<span class="n">pca</span><span class="o">.</span><span class="n">explained_variance_ratio_</span>
<span class="c1"># mean_: 每个特征的经验均值</span>
<span class="n">pca</span><span class="o">.</span><span class="n">mean_</span>
<span class="c1"># n_components_: 模型提取的特征数</span>
<span class="n">pca</span><span class="o">.</span><span class="n">n_components_</span>
<span class="c1"># 转换数据集数据</span>
<span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># 返回对数似然函数在样本上的平均值</span>
<span class="n">pca</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>


<h3>ICA, independent component analysis</h3>
<h3>FA</h3>
<h2>KNN, k-近邻</h2>
<h3>NearestNeighbors, 返回最近的邻居</h3>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">neighbors</span>
<span class="n">nbrs</span> <span class="o">=</span> <span class="n">neighbors</span><span class="o">.</span><span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ball_tree&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># 距离每个样本最近的样本点的索引</span>
<span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">kdt</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">return_distance</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>


<h3>KDTree, kd树</h3>
<div class="highlight"><pre><span></span>kdt = neighbors.KDTree(X, leaf_size=30, metric=&#39;euclidean&#39;)
</pre></div>


<h3>KNeighborsClassifier, kNN分类器</h3>
<div class="highlight"><pre><span></span>neigh = neighbors.KNeighborsClassifier(n_neighbors=3)
neigh.fit(X)
neigh.predict(Xs)
# freq(类)/k, 返回值是一个向量, 象征每个类在的k近邻经验概率分布
neigh.predict_proba(Xt)
# Returns the mean accuracy on the given test data and labels.
neigh.score(Xv, yv)
</pre></div>


<h2>NB, 朴素贝叶斯</h2>
<h3>一般朴素贝叶斯方法, MultinomialNB</h3>
<p>特征向量分量是离散变量时很有用</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">naive_bayes</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">naive_bayes</span><span class="o">.</span><span class="n">MutilnomialNB</span><span class="p">()</span>
<span class="n">nb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>


<p><strong><span class="math">\(\lambda = 0\)</span>是代表极大似然估计, <span class="math">\(\lambda = 1\)</span>是代表拉普拉斯平滑, <span class="math">\(\lambda &gt; 0\)</span>时是贝叶斯估计.</strong></p>
<h3>高斯朴素贝叶斯方法, GaussianNB</h3>
<p>假设特征向量分量关于Y的条件分布符合正态分布, 即<span class="math">\(P(X^i|Y)\)</span>是正态分布, 对X是连续变量时有用</p>
<div class="highlight"><pre><span></span>gnb = naive_bayes.GaussianNB()
gnb.fit(X)
</pre></div>


<h3>伯努利朴素贝叶斯方法， BernoulliNB</h3>
<p>假设特征向量分量关于Y的条件分布是伯努利分布</p>
<div class="highlight"><pre><span></span>bnb = naive_bayes.BernoulliNB(alpha=1.0)
bnb.fit(X)
</pre></div>


<p><strong><span class="math">\(\lambda = 0\)</span>是代表极大似然估计, <span class="math">\(\lambda = 1\)</span>是代表拉普拉斯平滑, <span class="math">\(\lambda &gt; 0\)</span>时是贝叶斯估计.</strong></p>
<h2>LR, 逻辑回归分类模型</h2>
<div class="math">$$
\min\limits_{w, b}{\frac{1}{2} {\lVert w \rVert}^2 + C \sum\limits_{i=1}{N}{log{(1+exp(-y_i(w \cdot x_i + b)))}}}
$$</div>
<p>
或者等价于
</p>
<div class="math">$$
\min\limits_{w, b}{\sum\limits_{i=1}^{N}{\log{(1+exp(-y_i(w \cdot x_i + b)))}} + \lambda {\lVert w \rVert}^2}
$$</div>
<p>
如果penalty='l1', 就将上面公式中的l2范数换成l1范数即可, 即各分量绝对值的和</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="c1"># penalty -&gt; 范数 or 惩罚函数,default=&#39;l2&#39;, C 惩罚系数, log(exp(-yi(w*xi+b))+1)的系数</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogsiticRegression</span><span class="p">(</span><span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="c1"># coef_ -&gt; w, intercept_ -&gt; b</span>
</pre></div>


<h2>SVM, 支持向量机</h2>
<h3>线性支持向量机</h3>
<div class="math">$$
\min\limits_{w, b}{\frac{1}{2} {\lVert w \rVert}^2 + C \sum\limits_{i=1}^{N}{[1-y_i(w \cdot x_i + b)]_{+}}}
$$</div>
<p>
或者等价于
</p>
<div class="math">$$
\min\limits_{w, b}{\sum\limits_{i=1}^{N}{[1-y_i(w \cdot x_i + b)]_{+}} + \lambda {\lVert w \rVert}^2}
$$</div>
<p>
如果penalty='l1', 就将上面公式中的l2范数换成l1范数即可, 即各分量绝对值的和</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="c1"># loss in [&#39;hingle&#39;, &#39;squard_hingle&#39;], default=&#39;hingle&#39;</span>
<span class="n">linear_svm</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">LinearSVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;hingle&#39;</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l2&#39;</span><span class="p">)</span>
</pre></div>


<h3>非线性支持向量机</h3>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="c1"># kernel is in [‘linear’, ‘poly’, ‘rbf’, ‘sigmoid’, ‘precomputed’ or a callable], default=&#39;rbf&#39;</span>
<span class="c1"># degree: degree for &#39;poly&#39;, ignored by all other method, default=3</span>
<span class="c1"># gamma: &#39;poly&#39;, &#39;rbf&#39;, &#39;sigmoid&#39;核函数系数, 如果选择&#39;auto&#39;的话, 1/n_features将被选择</span>
<span class="n">svc</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="n">de</span><span class="p">)</span>
</pre></div>


<h2>ME, 最大熵模型</h2>
<h2>DT, 决策树</h2>
<p>scikit-learn使用的是优化的CART算法</p>
<h3>分类树</h3>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">tree</span>
<span class="c1"># criterion: &#39;gini&#39;, &#39;entropy&#39;, default=&#39;gini&#39;</span>
<span class="n">dtc</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">DecisionTreeClassfier</span><span class="p">(</span><span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;gini&#39;</span><span class="p">)</span>
</pre></div>


<h3>回归树</h3>
<div class="highlight"><pre><span></span># criterion: &#39;mse&#39;, default=&#39;mse&#39;, mean squared error
dtr = tree.DecisionTreeRegressor(criterion=&#39;mse&#39;)
</pre></div>


<h2>BT, 提升树, Gradient Tree Boosting</h2>
<h3>分类, GradientBoostingClassifier</h3>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">ensemble</span>
<span class="n">gbc</span> <span class="o">=</span> <span class="n">ensemble</span><span class="o">.</span><span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>


<h3>回归, GradientBoostingRegressor</h3>
<div class="highlight"><pre><span></span>gbr = ensemble.GradientBoostingRegressor(n_estimators=100, learning_rate=0.1, max_depth=1, random_state=0, loss=&#39;ls&#39;).fit(X_train, y_train)
</pre></div>


<h2>AdaBoost, 提升方法</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostClassifier</span>

<span class="n">abclf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">abclf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>


<h2>HMM, 隐马尔科夫模型</h2>
<h2>CRF, 条件随机场</h2>
<h2>CV, 交叉验证</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">cross_validation</span>
<span class="c1"># cross_val_score, cross_val_predict</span>
<span class="c1"># 默认使用k-fold验证</span>
<span class="c1"># array-like, shape[0] = len(list(cv)) if type(cv) is not int else cv</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># shape=(n_samples, )</span>
<span class="n">predicted</span> <span class="o">=</span> <span class="n">cross_validation</span><span class="o">.</span><span class="n">cross_val_predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">predicted</span><span class="p">)</span>
</pre></div>


<h3>K-fold</h3>
<div class="highlight"><pre><span></span><span class="c1"># n -&gt; int, 样本的总数量, n_folds &lt;- number of folds, default=3, at least 2.</span>
kf <span class="o">=</span> cross_validation.KFold<span class="p">(</span><span class="m">4</span><span class="p">,</span> n_folds<span class="o">=</span><span class="m">2</span><span class="p">)</span>
<span class="c1"># train, test 是训练样本和验证样本的索引构成的列表</span>
<span class="kr">for</span> train<span class="p">,</span> test <span class="kr">in</span> kf<span class="o">:</span>
    <span class="p">(</span>train<span class="p">,</span> test<span class="p">)</span>
</pre></div>


<h3>LOO, Leave-One-Out</h3>
<div class="highlight"><pre><span></span># n -&gt; int, the total of elements
loo = cross_validation.LeaveOneOut(8)
for train, test in lo:
    (train, test)
</pre></div>


<h3>LPO, Leave-P-Out</h3>
<div class="highlight"><pre><span></span>lpo = cross_validation.LeavePOut(n, p)
</pre></div>


<p><strong>这些交叉验证的模型可以代入最上面的</strong><code>cross_val_score</code>, <code>cross_val_predict</code><strong>方法中</strong></p>
<h3>random permutations cross validation</h3>
<div class="highlight"><pre><span></span>ss = cross_validation.ShuffleSplit(5, n_iter=3, test_size=0.25, random_state=0)
</pre></div>


<h2>高斯混合模型</h2>
<p>非监督学习模型, unsupervised learning</p>
<div class="math">$$
P(y|\sigma) = \sum\limits_{k=1}^{K}{\alpha_{k}\phi(y|\sigma_{k})}
$$</div>
<div class="math">$$
{\phi}(y|\sigma_{k}) = \frac{1}{(2 \pi)^{\frac{p}{2}}{\sqrt(det({COVMAT}_k))}}exp(-\frac{1}{2}{(y-{\mu}_k)^T({COVMAT}_k)^{-1}(y-{\mu}_k)});
$$</div>
<p>
其中, <span class="math">\({COVMAT}_k\)</span>是 (n_features, n_features) 的矩阵, <span class="math">\({\mu}_k\)</span>是 (n_features, )向量</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">mixture</span>
<span class="n">gmm</span> <span class="o">=</span> <span class="n">mixture</span><span class="o">.</span><span class="n">GMM</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="c1"># 均值</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">means_</span>
<span class="c1"># 协方差</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">covars_</span>
<span class="c1"># 权重</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">weights_</span>
<span class="c1"># 预测</span>
<span class="n">gmm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">XP</span><span class="p">)</span>
</pre></div>


<p>高斯混合模型首先通过观测数据使用EM算法计算出模型的参数<span class="math">\(\sigma\)</span>, 然后通过计算出在给定的参数下, 观测数据最有可能通过第几个模型产生, 达到对数据进行分类的目的.</p>
<p>如果将其他概率密度替代高斯混合模型中的高斯分布密度, 那么就会得到相应的概率混合模型, 然后可以使用类似办法对类进行分类.</p>
<h2>聚类, Clustering</h2>
<h3>K-Means, k-均值, KMeans, MiniBatchKMeans</h3>
<p>输入参数: 聚类的个数</p>
<div class="math">$$
\min\sum\limits_{i=1}^{N}{\min\limits_{k}{\lVert x_i-{\mu}_k \rVert}^2}
$$</div>
<p><strong>MiniBatchKMeans</strong>是KMeans的变种, 可以减少运行时间.</p>
<h3>MeanShift, 将中心点逐渐移向密度最稠密的点</h3>
<p>scikit-learn使用的是<code>rbf kernel</code>, 高斯径向基函数.</p>
<h3>DBSCAN</h3>
<p>高密度区域天然被低密度区域分割</p>
<h2>二聚类, Biclustering</h2>
<h2>模型持久化</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">joblib.externals</span> <span class="kn">import</span> <span class="n">joblib</span>
<span class="c1"># 保存</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span><span class="s1">&#39;../../data/model/randomforest.pkl&#39;</span><span class="p">,</span><span class="n">compress</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># 加载</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;../../data/model/randomforest.pkl&#39;</span><span class="p">)</span>
</pre></div>


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            <p>
                <a href="http://mbsy.co/bHCMB" target="_blank" style="border:none;">
                    <img src="https://ambassador-api.s3.amazonaws.com/uploads/marketing/970/2014_09_22_13_34_17.gif" alt="Code School" border="0" />
                </a>
            </p>
            <br/>
            <br/>
<nav class="pagination" role="navigation">
    <ul>
    </ul>
</nav>            <br/>
        </section>
        <footer class="post-footer">
        </footer>
    </article>
</main>
        <footer class="site-footer clearfix" role="contentinfo" itemscope itemtype="http://schema.org/WPFooter">
            <section class="copyright">
                <a itemprop="url" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" class="tooltip" data-tooltip="CC BY-NC-SA" target="_blank">
                CC Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
            </section>
            <section class="poweredby">Proudly published with <a href="https://getpelican.org">Pelican</a></section>
        </footer>
    </div>
    <script type="text/javascript" src="http://forin-xyz.github.io/output/theme/js/jquery-1.11.2.min.js"></script>
    <script type="text/javascript" src="http://forin-xyz.github.io/output/theme/js/jquery.fitvids.min.js"></script>
    <script type="text/javascript" src="http://forin-xyz.github.io/output/theme/js/index.min.js"></script>
    <script>twemoji.parse(document, {"size":16});</script>
</body>
</html>