<!DOCTYPE html>
<html lang="cn">
<head>
        <meta charset="utf-8" />
        <title>耕有田，读有书 - 条件随机场</title>
        <link rel="stylesheet" href="http://forin-xyz.github.io/output/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="http://github.com/forin-xyz/">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="http://forin-xyz.github.io/output/">耕有田，读有书 </a></h1>
                <nav><ul>
                    <li><a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a></li>
                    <li><a href="http://forin-xyz.github.io/output/category/python.html">Python</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-10-tiao-jian-sui-ji-chang.html">《统计学习方法》读书笔记10-条件随机场</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-02-27T23:00:00+08:00">
                发表于: 2016年02月27日 星期Sat
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://forin-xyz.github.io/output/author/forin-xyz.html">forin-xyz</a>
        </address>
<p>In <a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a>.</p>
<p>tags: <a href="http://forin-xyz.github.io/output/tag/ji-qi-xue-xi.html">机器学习</a> <a href="http://forin-xyz.github.io/output/tag/tiao-jian-sui-ji-chang.html">条件随机场</a> <a href="http://forin-xyz.github.io/output/tag/conditional-random-field.html">conditional random field</a> <a href="http://forin-xyz.github.io/output/tag/crf.html">CRF</a> <a href="http://forin-xyz.github.io/output/tag/gai-lu-wu-xiang-tu-mo-xing.html">概率无向图模型</a> <a href="http://forin-xyz.github.io/output/tag/probabilisitic-undirected-graphical-model.html">probabilisitic undirected graphical model</a> <a href="http://forin-xyz.github.io/output/tag/ma-er-ke-fu-sui-ji-chang.html">马尔科夫随机场</a> <a href="http://forin-xyz.github.io/output/tag/markov-random-field.html">Markov random field</a> <a href="http://forin-xyz.github.io/output/tag/xian-xing-lian-tiao-jian-sui-ji-chang.html">线性链条件随机场</a> <a href="http://forin-xyz.github.io/output/tag/linear-chain-conditional-random-field.html">linear chain conditional random field</a> <a href="http://forin-xyz.github.io/output/tag/du-shu-bi-ji.html">读书笔记</a> </p>
</footer><!-- /.post-info --><h2>概率无向图模型</h2>
<p>概率无向图模型(probabilistic undirected graphical model),又称为马尔科夫随机场(Markov random field),是一个可以用无向图表示的联合概率分布。</p>
<h3>概率无向图定义</h3>
<p>概率图模型(probabilistic graphical model)是由图表示的概率分布。设有联合概率分布<span class="math">\(P(Y)\)</span>, <span class="math">\(Y \in \mathcal(Y)\)</span>是一组随机变量, 由无向图<span class="math">\(G=(V,E)\)</span>表示概率分布<span class="math">\(P(Y)\)</span>, 即在图G中,
节点v表示一个随机变量<span class="math">\(Y_{v}\)</span>, 边e表示随机变量之间的概率依存关系。</p>
<p>成对马尔科夫性: 设<span class="math">\(u\)</span>和<span class="math">\(v\)</span>是任意两个没有边连接的结点, 其他所有节的集合为<span class="math">\(O\)</span>,
</p>
<div class="math">$$ P(Y_{u},Y_{v}|Y_{O}) = P(Y_{u}|Y_{O})P(Y_{v}|Y_{O}) $$</div>
<p>局部马尔科夫性: 设<span class="math">\(v\)</span>是图G中任意一个结点,<span class="math">\(W\)</span>是与<span class="math">\(v\)</span>有边连接的所有结点, <span class="math">\(O\)</span>是除<span class="math">\(v, W\)</span>外所有节点，
</p>
<div class="math">$$ P(Y_{v},Y_{O}|Y_{W}) = P(Y_{v}|Y_{W})P(Y_{O}|Y_{W}) $$</div>
<p>
或等价地, 在$P(Y_{O}|P_{W}) \gt 0 $,
</p>
<div class="math">$$ P(Y_{v}|Y_{W}) = P(Y_{v}|Y_{W}, Y_{O})$$</div>
<p>全局马尔科夫性: 设结点集合<span class="math">\(A\)</span>,<span class="math">\(B\)</span>是被结点结合<span class="math">\(C\)</span>分开的任意结点集合,
</p>
<div class="math">$$ P(Y_{A},Y_{B}|Y_{C}) = P(Y_{A}|Y_{C}})P(Y_{B}|Y_{C}) $$</div>
<p><span class="math">\(Y_{S}\)</span>表示一个随机向量组,如果S表示一个结点集合的话。</p>
<p>上述成对的、局部的、全局的马尔科夫定义是等价的。</p>
<p><strong>定义1、 概率无向图模型</strong></p>
<blockquote>
<p>设有联合概率分布<span class="math">\(P(Y)\)</span>, 由无向图<span class="math">\(G=(V,E)\)</span>表示, 在图中, 结点表示随机变量, 边表示随机变量之间的依赖关系。
如果联合概率分布<span class="math">\(P(Y)\)</span>满足成对、局部或全局马尔科夫性，就称此联合概率分布为概率无向图模型，或称马尔科夫随机场。</p>
</blockquote>
<h3>概率无向图模型的因子分解 factorization</h3>
<p><strong>定义2、 团与最大团</strong></p>
<blockquote>
<p>无向图G中任何两个节点均有边连接的结点子集叫做团。若C是无向图G的一个团, 并且不能再加任何一个G的结点使其成为一个更大的团，则称此团为最大团(maximal clique).</p>
</blockquote>
<p>将概率无向图模型的联合概率分布表示为其最大团上的随机变量的函数的乘积形式的操作，称为概率无向图的因子分解(factorization).</p>
<div class="math">$$P(Y) = \frac{1}{Z} \prod \limits_{C}{\boldsystem{\Psi}_{C}(Y_C)}$$</div>
<p>
其中, <span class="math">\(Z\)</span>是规范化因子(normalization factor), 由式
</p>
<div class="math">$$ Z = \sum \limits_{Y} {\prod \limits_{C} {\boldsystem{\Psi}_{C} } }$$</div>
<p>函数<span class="math">\(\Psi_{C}(Y_{C}\)</span>称为势函数(potential function)。 这里要求势函数是严格正的, 通常定义为指数函数:
</p>
<div class="math">$$
\Psi_{C}(Y_{C}) = exp(_E(Y_{C}))
$$</div>
<p>概率无向图是由以下定理保证的</p>
<p><strong>定理1、 Hammersley-Clifford定理 Hammersley-Clifford Thoorem</strong></p>
<blockquote>
<p>概率无向图模型的联合概率分布可以表示为
<div class="math">$$
P(Y) = \frac{1}{Z} \prod \limits_{C}{\boldsystem{\Psi}_{C}(Y_C)}
$$</div>
<div class="math">$$ Z = \sum \limits_{Y} {\prod \limits_{C} {\boldsystem{\Psi}_{C} } }$$</div>
<span class="math">\(\Psi_{C}(Y_{C})\)</span>是C上定义的严格正函数</p>
</blockquote>
<h2>条件随机场的定义和形式</h2>
<p><strong>定义3、 条件随机场</strong></p>
<blockquote>
<p>设X与Y是随机变量， <span class="math">\(P(Y|X)\)</span>是在给定X的条件下Y的条件概率。若随机变量Y构成一个由无向图<span class="math">\(G=(V, E)\)</span>表示的马尔科夫随机场,即
<div class="math">$$
P(Y_{v}|X, Y_{w}, w \ne v) = P(Y_{v}|X, Y_{w}, w~v)
$$</div>
对任意节点v成立,则称条件概率分布<span class="math">\(P(Y|X)\)</span>为条件随机场。式中<span class="math">\(w~v\)</span>表示在图G中与节点v有边连接的所有结点，<span class="math">\(w \ne v\)</span>表示节点v以外所有节点, <span class="math">\(Y_{v},Y_{w}\)</span>为结点对应的随机变量。</p>
</blockquote>
<p><strong>定义4、 线性链条件随机场</strong></p>
<blockquote>
<p>设<span class="math">\(X=(X_1, X_2, \cdots, X_{n}), Y=(Y_1, Y_2, \cdots, Y_{n})\)</span>均为线性链表示的随机变量序列, 若在给定随机变量序列<span class="math">\(X\)</span>的条件下，随机变量序列<span class="math">\(Y\)</span>的条件概率分布<span class="math">\(P(Y|X)\)</span>构成条件条件随机场，即满足马尔科夫性
<div class="math">$$
P(Y_i|X, Y_1,\cdots, Y_{i-1}, Y_{i+1}, \cdots, Y_n) = P(Y_i|X,Y_{i-1}, Y_{i+1})
$$</div>
在i=1和n时只考虑单边</p>
<p>则称<span class="math">\(P(Y|X)\)</span>为线性链条件随机场。在标注问题中， X表示观测序列，Y表示对应的输出标记序列或状态l序列。</p>
</blockquote>
<p>线性链，故名思议，其对应的图像一个链条一样, 每一个结点只与相邻的两个结点间有边, 首尾节点更是只有一个相连的结点，这样，其最大团也就是相邻两个结点的集合。</p>
<h3>条件随机场的参数化形式</h3>
<p><strong>定理2、 线性链条件随机场的参数化形式</strong></p>
<blockquote>
<p>设<span class="math">\(P(Y|X)\)</span>为线性链条件随机场, 则在随机变量<span class="math">\(X\)</span>取值为<span class="math">\(x\)</span>的条件下, 随机变量<span class="math">\(Y\)</span>取值为<span class="math">\(y\)</span>的条件概率具有如下形式
<div class="math">$$
P(y|x) = \frac{1}{Z(x)}exp(\sum\limits_{i,k}{\lambda _{k}t_{k}(y_{i-1},y_{i},x,i)} + \sum\limist_{i,l}{\mu_{l}s_{l}(y_i, x, i)})
$$</div>
<div class="math">$$
Z(x) = \sum\limits_{y}{exp(\sum\limits_{i,k}{\lambda _{k}t_{k}(y_{i-1},y_{i},x,i)} + \sum\limist_{i,l}{\mu_{l}s_{l}(y_i, x, i)})}
$$</div>
式中<span class="math">\(t_k,s_l\)</span>为特征函数，<span class="math">\(\lambda _{k} , \mu _{l}\)</span>是对应的权值。求和表示在所有核能的输出序列上进行。</p>
</blockquote>
<p><span class="math">\(t_k\)</span>是定义在边上的特征函数, 称为转移特征, 依赖于当前和前一个位置</p>
<p><span class="math">\(s_l\)</span>是定义在节点上的特征函数，称为状态特征，依赖于当前位置</p>
<h3>条件随机场的简化形式</h3>
<h3>条件随机场的矩阵形式</h3>
<h2>条件随机场的概率计算问题</h2>
<h2>条件随机场的学习算法</h2>
<h2>中英文对照表</h2>
<p>条件随机场 conditional random field, CRF</p>
<p>线性链 linear chain</p>
<p>概率无向图模型 probabilistic undirected graphical model</p>
<p>马尔科夫随机场 Markov random field</p>
<p>图 graph</p>
<p>节点 node</p>
<p>边 edge</p>
<p>概率图模型 probabilistic graphical model</p>
<p>成对马尔科夫性 pairwise Markov property</p>
<p>局部马尔科夫性 local Markov property</p>
<p>全局马尔科夫性 global Markov property</p>
<p>团 clique</p>
<p>最大团 maximal clique</p>
<p>因子分解 factorization</p>
<p>规范化因子 normalization factor</p>
<p>势函数 potential function</p>
<p>线性链条件随机场 linear chain conditional field</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://forin-xyz.github.io/tutorial.html">我的导航</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="http://weibo.com/u/1756830393">微博</a></li>
                            <li><a href="http://github.com/forin-xyz">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
        </footer><!-- /#contentinfo -->

</body>
</html>