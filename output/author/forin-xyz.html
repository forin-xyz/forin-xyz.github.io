<!DOCTYPE html>
<html lang="cn">
<head>
        <meta charset="utf-8" />
        <title>耕有田，读有书 - forin-xyz</title>
        <link rel="stylesheet" href="http://forin-xyz.github.io/output/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
<a href="http://github.com/forin-xyz/">
<img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
</a>
        <header id="banner" class="body">
                <h1><a href="http://forin-xyz.github.io/output/">耕有田，读有书 </a></h1>
                <nav><ul>
                    <li><a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a></li>
                    <li><a href="http://forin-xyz.github.io/output/category/python.html">Python</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-10-tiao-jian-sui-ji-chang.html">《统计学习方法》读书笔记10-条件随机场</a></h1>
<footer class="post-info">
        <abbr class="published" title="2016-02-27T23:00:00+08:00">
                发表于: 2016年02月27日 星期六
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://forin-xyz.github.io/output/author/forin-xyz.html">forin-xyz</a>
        </address>
<p>In <a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a>.</p>
<<<<<<< HEAD
<p>tags: <a href="http://forin-xyz.github.io/output/tag/ji-qi-xue-xi.html">机器学习</a> <a href="http://forin-xyz.github.io/output/tag/tiao-jian-sui-ji-chang.html">条件随机场</a> <a href="http://forin-xyz.github.io/output/tag/conditional-random-field.html">conditional random field</a> <a href="http://forin-xyz.github.io/output/tag/crf.html">CRF</a> <a href="http://forin-xyz.github.io/output/tag/gai-lu-wu-xiang-tu-mo-xing.html">概率无向图模型</a> <a href="http://forin-xyz.github.io/output/tag/probabilisitic-undirected-graphical-model.html">probabilisitic undirected graphical model</a> <a href="http://forin-xyz.github.io/output/tag/ma-er-ke-fu-sui-ji-chang.html">马尔科夫随机场</a> <a href="http://forin-xyz.github.io/output/tag/markov-random-field.html">Markov random field</a> <a href="http://forin-xyz.github.io/output/tag/xian-xing-lian-tiao-jian-sui-ji-chang.html">线性链条件随机场</a> <a href="http://forin-xyz.github.io/output/tag/linear-chain-conditional-random-field.html">linear chain conditional random field</a> <a href="http://forin-xyz.github.io/output/tag/du-shu-bi-ji.html">读书笔记</a> </p>
</footer><!-- /.post-info --><h2>中英文对照表</h2>
<p>条件随机场 conditional random field, CRF</p>
<p>线性链 linear chain</p>
<p>概率无向图模型 probabilistic undirected graphical model</p>
<p>马尔科夫随机场 Markov random field</p>
<p>图 graph</p>
<p>节点 node</p>
<p>边 edge</p>
<p>概率图模型 probabilistic graphical model</p>
<p>成对马尔科夫性 pairwise Markov property</p>
<p>局部马尔科夫性 local Markov property</p>
<p>全局马尔科夫性 global Markov property</p>
<p>团 clique</p>
<p>最大团 maximal clique</p>
<p>因子分解 factorization</p>
<p>规范化因子 normalization factor</p>
<p>势函数 potential function</p>
<p>线性链条件随机场 linear chain conditional field</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">
=======
<p>tags: <a href="http://forin-xyz.github.io/output/tag/ji-qi-xue-xi.html">机器学习</a> <a href="http://forin-xyz.github.io/output/tag/po-su-bei-xie-si.html">朴素贝叶斯</a> <a href="http://forin-xyz.github.io/output/tag/naive-bayes.html">Naive Bayes</a> <a href="http://forin-xyz.github.io/output/tag/python.html">python</a> <a href="http://forin-xyz.github.io/output/tag/ji-suan-ji-ke-xue.html">计算机科学</a> <a href="http://forin-xyz.github.io/output/tag/shu-xue-yuan-li.html">数学原理</a> <a href="http://forin-xyz.github.io/output/tag/du-shu-bi-ji.html">读书笔记</a> </p>
</footer><!-- /.post-info --><h2>原理</h2>
<h3>贝叶斯定理</h3>
<p>事件A和事件B同时发生的概率等于事件B发生的概率与事件A在事件B已经发生的条件下发生的概率的乘积, 即
</p>
<div class="math">$$ P(A, B) = P(AB) = P(A|B)P(B) $$</div>
<h3>贝叶斯公式</h3>
<div class="math">$$ P(A_{i}|B) = \frac{P(B|A_{i})P(A_{i})}{P(B)} $$</div>
<p>
其中
</p>
<div class="math">$$ P(B) = \sum\limits_{i=0}{n}P(B|A_{i})P(A_{i}) $$</div>
<p>
于是
</p>
<div class="math">$$ P(A_{i}|B) = \frac{P(B|A_{i})P(A_{i})}{\sum\limits_{i=0}{n}P(B|A_{i})P(A_{i})} $$</div>
<p>
这就是贝叶斯公式, 其中<span class="math">\(\{A_{i}\}\)</span>为完备事件组,即<span class="math">\(\bigcup \limits_{i}A_{i} = \Omega, A_{i}A_{j} = \phi,(i \ne j), P(A_{i}) &gt; 0\)</span>.</p>
<h3>朴素贝叶斯方法的基本描述</h3>
<p>输入空间<span class="math">\(\mathcal{X} \subseteq \mathrm{R}^{n}\)</span>是n维向量的几何
输出空间<span class="math">\(\mathcal{Y} = \{c_{1}, c_{2}, \cdots, c_{K}\}\)</span>是类标记组合
朴素贝叶斯方法是求特定输入下的后验概率最大化。</p>
<h3>特征条件相互独立假设</h3>
<p>朴素贝叶斯方法对条件概率分布做了互相独立的假设，即在输出一定的条件下，实例点的特征分量彼此相互独立，即：
</p>
<div class="math">$$\begin{aligned}
P(X = x|Y = c_{k}) =&amp; P(X^{1}=x^{1}, \cdots, X^{n}=x^{n}|Y=c_{k})\\
=&amp;\prod\limits_{j=1}{n}P(X^{j}=x^{j}|Y=c_{k})
\end{aligned}
$$</div>
<h3>朴素贝叶斯方法的最终推导</h3>
<p>将特征条件相互独立代入到贝叶斯公式， 有
</p>
<div class="math">$$
P(Y=c_{k}|X=x)=\frac{P(Y=c_{k})\prod\limits_{j=1}{n}P(X^{j}=x^{j}|Y=c_{k})}{\sum_{k}{P(Y=c_k)}\prod_{j}{P(X^{j}=x^{j}|Y=c_{k})}}
$$</div>
<p>
朴素贝叶斯分类器就是选取在给定的输入的情况下，将后验概率最大的类最为输出的分类的方法，又
由于分子对于每一个给定的<span class="math">\(c_{k}\)</span>是相同的,于是
</p>
<div class="math">$$
y = \arg\max\limits_{c_{k}}{P(Y=c_{k})}\prod\limits_{j=1}{n}{P(X^{j}=x^{j}|Y=c_{k})}
$$</div>
<p>
就是朴素贝叶斯分类器的最终模式。</p>
<h3>后验概率最大化的意义</h3>
<p>朴素贝叶斯方法将实例分到后验概率最大的类中，等价于0-1损失函数下期望风险最小化。</p>
<p>假设联合概率分布为<span class="math">\(P(X,Y)\)</span>, 对于给定的决策函数<span class="math">\(f\)</span>，期望风险
</p>
<div class="math">$$R_{exp}(f) = E_{X}\sum\limits_{k=1}{K}\lbrack L(c_{k}, f(X))\rbrack P(c_{k}|X)
$$</div>
<p>
要使得期望风险最小，于是
</p>
<div class="math">$$\begin{aligned}
f(x) =&amp; \arg \min\limits_{c_{k}}P(y \neq c_{k}|X=x)
=&amp; \arg \min\limits_{c_{k}}{1-P(y=c_{k}|X=x)} \\
=&amp; \arg \max\limits_{c_{k}}P(c_{k}|X=x)
\end{aligned}$$</div>
<h2>朴素贝叶斯方法的参数估计</h2>
<h3>极大似然估计</h3>
<div class="math">$$P(Y=c_{k}) = \frac{freq(y=c_{k})}{N}$$</div>
<p>
其中<span class="math">\(freq\)</span>为频数函数。
</p>
<div class="math">$$P(X^{(j)}=a_{jl}|c_{k})=\frac{freq(x^{(j)}=a_{jl},c_{k})}{freq(c_{k})}$$</div>
<p>
其中<span class="math">\(a_{jl}\)</span>表示第j个特征可能取得的第l个值。
将上述两式带入到朴素贝叶斯分类器模型就可以得到极大似然估计。</p>
<h4>朴素贝叶斯方法的极大似然估计算法</h4>
<p><em>naive Bayes algorithm</em> <strong>朴素贝叶斯算法</strong></p>
<blockquote>
<p>输入: 训练数据集<span class="math">\(T=\{(x_{1},y{1}), \cdots, (x_{N}, y_{N})\}\)</span>,其中<span class="math">\(x_{i}=(x_{i}^{(1)}, \cdots, x_{i}^{(n)})^{T}\)</span>, <span class="math">\(x_{i}^{(j)}\)</span>是第i个样本的第j个特征, <span class="math">\(x_{i}^{(j)} \in {a_{j1}, \cdots, a_{jS_{j}}}\)</span>, <span class="math">\(a_{jh}是第j个特征可能取得的第l个值, $y_{i} \in \{c_{1}, \cdots, c_{K}\}\)</span>; 实例<span class="math">\(x\)</span>.</p>
<p>输出: 实例x的分类</p>
<p>(1) 计算先验概率和条件概率</p>
<p>
<div class="math">$$P(c_{k})$$</div>
</p>
<p>
<div class="math">$$P(a_{jh}|c_{k})$$</div>
</p>
<p>(2) 对于给定的实例, 计算</p>
<p>
<div class="math">$$P(c_{k})\prod\limits_{j=1}{n}P(x^{(j)}|c_{k})$$</div>
</p>
<p>(3) 取上面结果最大的类作为实例<span class="math">\(x\)</span>的类输出。</p>
</blockquote>
<h4>朴素贝叶斯方法的极大似然估计的python实现</h4>
<p><a href="https://github.com/forin-xyz/statistical-learning-method/blob/master/naive_bayes_MLE.py" title="github">朴素贝叶斯-极大似然估计</a></p>
<div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">naive_bayes_MLE_train</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="kp">shape</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xl</span><span class="p">:</span>
        <span class="n">xl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">yl</span><span class="p">:</span>
        <span class="n">yl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yl</span><span class="p">)</span>
    <span class="c"># 统计y各个结果出现的频次</span>
    <span class="n">yf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">([(</span><span class="n">y</span><span class="o">==</span><span class="n">ylit</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">ylit</span> <span class="ow">in</span> <span class="n">yl</span><span class="p">])</span>
    <span class="c"># 统计x^j,y出现的频次</span>
    <span class="n">xfmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">xlit</span><span class="p">)</span> <span class="k">for</span> <span class="n">xlit</span> <span class="ow">in</span> <span class="n">xl</span><span class="p">])))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">yl</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
            <span class="n">xfmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">h</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c"># 计算出各个类后验概率的分母</span>
    <span class="n">py</span> <span class="o">=</span> <span class="n">yf</span><span class="o">/</span><span class="n">N</span>
    <span class="n">pxmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">([</span><span class="n">xfmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">/</span> <span class="n">yf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)])</span>
    <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">pkx</span> <span class="o">=</span> <span class="n">py</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">pkx</span> <span class="o">*=</span> <span class="n">pxmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])]</span>
        <span class="n">pyx</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pkx</span>
    <span class="k">return</span> <span class="n">yl</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="kp">argmax</span><span class="p">(</span><span class="n">pyx</span><span class="p">)]</span>

<span class="c"># 测试</span>

<span class="k">def</span> <span class="nf">test_naive_bayes_MLE_train</span><span class="p">():</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">]</span>
        <span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
         <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">]</span>
    <span class="n">yo</span> <span class="o">=</span> <span class="n">naive_bayes_MLE_train</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yo</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;test naive_bayes_MLE_train successed!&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;test naive_bayes_MLE_train failed!&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">test_naive_bayes_MLE_train</span><span class="p">()</span>
</pre></div>


<h3>贝叶斯估计</h3>
<p>贝叶斯估计等价于在随机变量各个取值的频数上赋予一个正数</p>
<div class="math">$$\lambda$$</div>
<p>.</p>
<div class="math">$$P_{\lambda}(X^{(j)}=a_{jl}|c_{k})=\frac{freq(x^{(j)}=a_{jl},c_{k})+\lambda}{freq(c_{k})+S_{j}\lambda}$$</div>
<p>
其中<span class="math">\(S_{j}\)</span>表示第j个特征可能取值的集合的元素个数。
</p>
<div class="math">$$P_{\lambda}(Y=c_{k}) = \frac{freq(y=c_{k})+\lambda}{N+K\lambda}$$</div>
<h4>朴素贝叶斯方法的贝叶斯估计的python实现</h4>
<p><a href="https://github.com/forin-xyz/statistical-learning-method/blob/master/naive_bayes_BE.py" title="github">朴素贝叶斯-贝叶斯估计</a></p>
<div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">贝叶斯方法的贝叶斯估计实现</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">naive_bayes_BE_train</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">xl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">yl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">lambdas</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="kp">shape</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">xl</span><span class="p">:</span>
        <span class="n">xl</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">yl</span><span class="p">:</span>
        <span class="n">yl</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">K</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">yl</span><span class="p">)</span>
    <span class="c"># 统计y各个结果出现的频次</span>
    <span class="n">yf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">([(</span><span class="n">y</span><span class="o">==</span><span class="n">ylit</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">ylit</span> <span class="ow">in</span> <span class="n">yl</span><span class="p">])</span>
    <span class="c"># 统计x^j,y出现的频次</span>
    <span class="n">xfmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">((</span><span class="n">K</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">max</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">xlit</span><span class="p">)</span> <span class="k">for</span> <span class="n">xlit</span> <span class="ow">in</span> <span class="n">xl</span><span class="p">])))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">yl</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
            <span class="n">xfmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">h</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="c"># 计算出各个类后验概率的分母</span>
    <span class="n">py</span> <span class="o">=</span> <span class="p">(</span><span class="n">yf</span> <span class="o">+</span> <span class="n">lambdas</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">N</span><span class="o">+</span><span class="n">K</span><span class="o">*</span><span class="n">lambdas</span><span class="p">)</span>
    <span class="n">pxmatrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">([[(</span><span class="n">xfmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="p">:]</span><span class="o">+</span><span class="n">lambdas</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">yf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">*</span> <span class="n">lambdas</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">)])</span>
    <span class="n">pyx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">K</span><span class="p">):</span>
        <span class="n">pkx</span> <span class="o">=</span> <span class="n">py</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">pkx</span> <span class="o">*=</span> <span class="n">pxmatrix</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">xl</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">])]</span>
        <span class="n">pyx</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">pkx</span>
    <span class="k">return</span> <span class="n">yl</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="kp">argmax</span><span class="p">(</span><span class="n">pyx</span><span class="p">)]</span>


<span class="c"># 测试</span>

<span class="k">def</span> <span class="nf">test_naive_bayes_BE_train</span><span class="p">():</span>
    <span class="n">X</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span>
         <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;M&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">&#39;L&#39;</span><span class="p">]</span>
        <span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
         <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">xi</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">]</span>
    <span class="n">yo</span> <span class="o">=</span> <span class="n">naive_bayes_BE_train</span><span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">lambdas</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yo</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;test naive_bayes_BE_train successed!&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;test naive_bayes_BE_train failed!&#39;</span><span class="p">)</span>
>>>>>>> 976a51f90d243a3207ac25ea808474085930a73b

            <li><article class="hentry">
                <header>
                    <h1><a href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-7-ti-sheng-fang-fa.html" rel="bookmark"
                           title="Permalink to 《统计学习方法》读书笔记7-提升方法，含python实现代码">《统计学习方法》读书笔记7-提升方法，含python实现代码</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-24T23:00:00+08:00">
                发表于: 2016年02月24日 星期三
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://forin-xyz.github.io/output/author/forin-xyz.html">forin-xyz</a>
        </address>
<p>In <a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a>.</p>
<p>tags: <a href="http://forin-xyz.github.io/output/tag/ji-qi-xue-xi.html">机器学习</a> <a href="http://forin-xyz.github.io/output/tag/ti-sheng-fang-fa.html">提升方法</a> <a href="http://forin-xyz.github.io/output/tag/du-shu-bi-ji.html">读书笔记</a> <a href="http://forin-xyz.github.io/output/tag/adaboost.html">AdaBoost</a> <a href="http://forin-xyz.github.io/output/tag/ti-sheng-shu.html">提升树</a> <a href="http://forin-xyz.github.io/output/tag/boosting-tree.html">boosting tree</a> </p>
</footer><!-- /.post-info -->                <p>提升方法是一种常用的统计学习方法, 它通过改变样本的权重，学习多个分类器，并将这些分类器进行线性组合，提高分类的性能。AdaBoost算法是最具代表性的提升算法，提升树则是更具体的实例。</p>
                <a class="readmore" href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-7-ti-sheng-fang-fa.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-5-po-su-bei-xie-si-fang-fa.html" rel="bookmark"
                           title="Permalink to 《统计学习方法》读书笔记5-朴素贝叶斯方法，含python源码">《统计学习方法》读书笔记5-朴素贝叶斯方法，含python源码</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-21T23:00:00+08:00">
                发表于: 2016年02月21日 星期日
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://forin-xyz.github.io/output/author/forin-xyz.html">forin-xyz</a>
        </address>
<p>In <a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a>.</p>
<p>tags: <a href="http://forin-xyz.github.io/output/tag/ji-qi-xue-xi.html">机器学习</a> <a href="http://forin-xyz.github.io/output/tag/po-su-bei-xie-si.html">朴素贝叶斯</a> <a href="http://forin-xyz.github.io/output/tag/naive-bayes.html">Naive Bayes</a> <a href="http://forin-xyz.github.io/output/tag/python.html">python</a> <a href="http://forin-xyz.github.io/output/tag/ji-suan-ji-ke-xue.html">计算机科学</a> <a href="http://forin-xyz.github.io/output/tag/shu-xue-yuan-li.html">数学原理</a> <a href="http://forin-xyz.github.io/output/tag/du-shu-bi-ji.html">读书笔记</a> </p>
</footer><!-- /.post-info -->                <p>朴素贝叶斯方法(Naive Bayesian Method)是基于贝叶斯定理与特征 条件独立假设的分类方法，是一种常见和高效的学习方法。</p>
                <a class="readmore" href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-5-po-su-bei-xie-si-fang-fa.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-2-cong-gan-zhi-ji-dao-zhi-chi-xiang-liang-ji.html" rel="bookmark"
                           title="Permalink to 《统计学习方法》读书笔记2-从感知机到支持向量机，含python源码">《统计学习方法》读书笔记2-从感知机到支持向量机，含python源码</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2016-02-18T23:00:00+08:00">
                发表于: 2016年02月18日 星期四
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://forin-xyz.github.io/output/author/forin-xyz.html">forin-xyz</a>
        </address>
<p>In <a href="http://forin-xyz.github.io/output/category/ji-qi-xue-xi.html">机器学习</a>.</p>
<p>tags: <a href="http://forin-xyz.github.io/output/tag/ji-qi-xue-xi.html">机器学习</a> <a href="http://forin-xyz.github.io/output/tag/gan-zhi-ji.html">感知机</a> <a href="http://forin-xyz.github.io/output/tag/perceptron.html">perceptron</a> <a href="http://forin-xyz.github.io/output/tag/zhi-chi-xiang-liang-ji.html">支持向量机</a> <a href="http://forin-xyz.github.io/output/tag/super-vector-machines.html">super vector machines</a> <a href="http://forin-xyz.github.io/output/tag/svm.html">SVM</a> <a href="http://forin-xyz.github.io/output/tag/python.html">python</a> <a href="http://forin-xyz.github.io/output/tag/ji-suan-ji-ke-xue.html">计算机科学</a> <a href="http://forin-xyz.github.io/output/tag/shu-xue-yuan-li.html">数学原理</a> <a href="http://forin-xyz.github.io/output/tag/du-shu-bi-ji.html">读书笔记</a> </p>
</footer><!-- /.post-info -->                <p>感知机(perceptron)是二类分类的线性分类模型(linear classfication model)，对应于一个特征空间(feature space)中的一个将实例划分为正负两类的分离超平面(separating hyperplane)。可以使用梯度下降法(gradient descent)对感知机模型的损失函数进行极小化求出模型参数。支持向量机(support vector machines, SVM)也是二类分类模型，线性支持向量机(linear support vector machine)与感知机(perceptron)不同在于其使间隔最大化。通过核技巧(kernel trick)以及软间隔最大化(soft margin maximization),可以学习非线性支持向量机(non-linear support vector machine)。支持向量机的学习算法就是求解凸二次规划的最优化算法。</p>
                <a class="readmore" href="http://forin-xyz.github.io/output/2016/02/du-shu-bi-ji-2-cong-gan-zhi-ji-dao-zhi-chi-xiang-liang-ji.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://forin-xyz.github.io/output/2010/12/my-test-post.html" rel="bookmark"
                           title="Permalink to My test title">My test title</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2010-12-03T10:20:00+08:00">
                发表于: 2010年12月03日 星期五
        </abbr>
		<br />
        <abbr class="modified" title="2010-12-05T19:30:00+08:00">
                修改于: 2010年12月05日 星期日
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://forin-xyz.github.io/output/author/forin-xyz.html">forin-xyz</a>
        </address>
<p>In <a href="http://forin-xyz.github.io/output/category/python.html">Python</a>.</p>
<p>tags: <a href="http://forin-xyz.github.io/output/tag/pelican.html">pelican</a> <a href="http://forin-xyz.github.io/output/tag/publishing.html">publishing</a> </p>
</footer><!-- /.post-info -->                <p>Short version for index and feeds</p>
                <a class="readmore" href="http://forin-xyz.github.io/output/2010/12/my-test-post.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://forin-xyz.github.io/tutorial.html">我的导航</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="http://weibo.com/u/1756830393">微博</a></li>
                            <li><a href="http://github.com/forin-xyz">github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
        </footer><!-- /#contentinfo -->

</body>
</html>