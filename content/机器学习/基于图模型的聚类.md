Title: 基于图模型的聚类
Date: 2016-10-14 19:08
Category: 机器学习
Tags: 图模型, 图像分割, 最小生成树, 文本分类
Summary: 基于图模型的聚类是一种比较快速有效的聚类方法, 他是最小生成树算法的一种推广。


## 介绍

图模型是非常重要的一种模型, 他可以用来表示同类事物之间关系的网络, 也可以用来表示不同类事物之间的作用与反作用。

## 算法描述

1. 对于需要聚类之间的点,将他们每个点看成一个类,然后求出每个类之间的距离(用点与点之间的距离代替)
2. 根据设定的阈值，将类之间进行合并，并根据一定的更新方法，求出新的图模型之间类与类的两两距离
3. 重复过程2,直到所有的类归并为同一个类
4. 根据不同的细粒度，可以按照类的个数或者不同阈值在一定程度上提前终止迭代。

这个模型实质上就是最小生成树(MST)模型的推广衍生版本。

## 应用

### 基于图模型的图像分割

[论文Efficient Graph-Based Image Segmentation](http://www.lcg.ufrj.br/~marroquim/courses/cos756/trabalhos/2011/alejandra-klachquin/alejandra-klachquin-slides.pdf)

将图像转化为图,就是将像素点看成顶点,只有相邻的像素点之间才有边连接(有8个方向),边的权重取颜色差异(像素距离), 不相邻的边之间距离为正无穷。
描述:

对于两个像素点之间,使用RGB模型的L2范数作为距离,即:
$$
d = \sqrt{(r_1-r_2)^2 + (g_1 - g_2)^2 + (b_1 - b_2)^2}
$$
当然也可以使用其他颜色空间和其他的距离公式,也可以对图像进行滤波后再进行距离计算。

对于类或者区域之间的归并,使用的是自适应阈值法，他们由下面两个值决定，最开始可以将单独一个像素点看成一个类

类内差异
$$
Int(C) = \max_{e \in (MST,E)}{e}
$$
就是所有像素点之间距离（亮度差异）最大的一条边。

类间差异
$$
Diff(C_1, C_2) = \min_{v_1 \in C_1, v_2 \in C_2, e =\lt v_1, v_2 \gt,e \in E(C_1, C_2) }{e}
$$
也就是连接两个区域之间边的最小值

归并条件
$$
Diff(C_1, C_2) \le \min{(Int(C_1), Int(C_2))}
$$
也就是相当于两个区域所能容忍的最大差异，要比两者之间的最小差异要小. 那么就合并之。

对于一开始的孤立像素点,因为没有边,类内差异为0,所以会导致无法进行有效合并。所以未来防止分割过细的情况存在,可以在类内距离上增加一个跟区域大小相关的容忍度
即
$$
r(C) = \frac{k}{\lvert C \rvert}
$$
最后的归并标准就变成了
$$
Diff(C_1, C_2) \le \min{(Int(C_1) + r(C_1), Int(C_2) + r(C_2))}
$$


**Algorithm**:
1. Caculate all edges' weight
2. sort edges by weight, get e1, e2, e3, ..., eN
3. select ei, i for 1 to N
4. 对边连接的两个顶点跟据归并条件判断是否合并,如果合并则到Step 3,不合并就到调到step 5
5. 更新阈值和类标记
　　类标号: 将id(vi), id(vj)的类标号统一为id(vi)的标号
  　不相似度阈值: wij + k/(|C1|+|C2|)
   跳到Step 3

####

也可以将区域的形状信息加入到不相似度之间的差异中, 这样就可以聚类到特定形状的区域。

### 基于图模型的文本聚类

对于文本, 选择word vector作为特征值, 使用余弦相似度作为他们之间的距离
$$
cosine(A_1, A_2) = \frac{\lt v_1, v_2 \gt}{\lVert v_1 \rVert \lVert v_2 \rVert}
$$
相似度越大,说明文本之间的同类的可能性就越大。

合并方式可以采用两两合并或者阈值合并。

对于归并后的类, 之间将两个类的合并成同一个类(文章),　然后更新这个两两之间的距离, 继续进行聚合，直到最后归并成同一个超级类。

## 优点

计算量比较小,算法过程比较有趣。It's useful for many questions.